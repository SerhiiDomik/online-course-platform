{% extends "base.html" %}

{% block title %}{{ course.name }}{% endblock %}

{% block content %}
<div class="detail-header">
  <div class="d-flex justify-content-between align-items-center">
    <h2>{{ course.name }}</h2>
    <div class="button-group">
      {% if course not in user.saved_courses.all %}
        <a href="{% url 'course:save-course' course.pk %}?next={{ request.path }}" class="btn btn-secondary">Save</a>
      {% endif %}
      {% if request.user == course.created_by %}
        <a href="{% url 'course:course-update' course_pk=course.pk %}" class="btn btn-default">Update</a>
        <a href="{% url 'course:course-delete' course_pk=course.pk %}" class="btn btn-default">Delete</a>
      {% endif %}
    </div>
  </div>
  <p class="lesson-content">{{ course.description }}</p>
  <p class="text-muted">Created by <b>{{ course.created_by.username }}</b> on {{ course.created_at|date:"F j, Y" }}</p>
</div>

<div class="lesson-container">
  <h3>Lessons</h3>
  <ul class="lesson-list">
    {% for lesson in lessons %}
      <li>
        <a href="{% url 'course:lesson-detail' course_pk=course.pk lesson_pk=lesson.pk %}">{{ lesson.title }}</a>
        {% if lesson in user.finished_lessons.all %}
          <span class="badge badge-success">Completed</span>
        {% endif %}
      </li>
    {% empty %}
      <p>No lessons yet.</p>
    {% endfor %}
  </ul>
  {% if request.user == course.created_by %}
    <a style="margin-left: 0" href="{% url 'course:lesson-create' course.pk %}" class="btn-success">Create new lesson</a>
  {% endif %}
</div>

<a href="{% url 'course:course-list' %}" class="back-button">Back to courses</a>
{% endblock %}
